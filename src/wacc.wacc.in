begin

#include "lexer.wacc.in"
#include "io.wacc.in"

LEXER_FN(VOID, lexer_print)
    print "Lexer{current: ";
    print current;
    print ", start: ";
    print start;
    print ", logical_line: ";
    print logical_line;
    println "}";
ENDV

// ============= Main function ==============
DISCARD_INIT;

char[] end_of_input = [];
char[][] input = call read_all(end_of_input);

LEXER_T lexer = call lexer_new(input, end_of_input);

bool run = true;
while run do
    TOKEN_T t = call next_token(lexer);
    DISCARD_ print_token(t);
    TOKEN_TYPE tt = call token_type(t);
    run = tt != TOKEN_EOF;
    DISCARD_ lexer_print(lexer)
    // DISCARD_ token_free(t)
done ;

// DISCARD_ lexer_free(lexer);
skip

end