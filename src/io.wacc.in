#ifndef IO_WACC_IN
#define IO_WACC_IN

#include "../gen/alloc.wacc.in"
#include "utils.wacc.in"

// Iurii extension;
extern int getchar()

pair(char[], int) readAll() is
    int maxLen = 1000;

    char[] buffer = call calloc(1000);
    // TODO: Realloc buffer
    int i = 0;
    bool run = true;
    while (run) do
        int c = call getchar();
        if (c == -1) then
            run = false
        else
            if i == maxLen then 
                println "Input file too big";
                FAIL
            ENDIF ;

            buffer[i] = chr c;
            i = i + 1
        fi
    done ;
    RETVRN(pair(char[], int), newpair(buffer, i))
end

VOID printStr(char[] str, int start, int lenn) is
    int i = 0;
    while (i < lenn) do
        print str[start + i];
        i = i + 1
    done ;
ENDV

#endif